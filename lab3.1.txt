; Метод ділення відрізка навпіл (метод бісекції)
(define (search f neg-point pos-point)
    (let ((midpoint (average neg-point pos-point)))
         (if (close-enough? neg-point pos-point)
             midpoint
             (let ((test-value (f midpoint)))
                  (cond ((positive? test-value)
                                (search f neg-point midpoint))
                    ((negative? test-value)
                                (search f midpoint pos-point))
                    (else midpoint))))))
                
(define (average x y)
    (/ (+ x y) 2))

(define (abs x)
  (cond ((< x 0) (- x))
        (else x)))
    
(define (close-enough? x y)
    (< (abs (- x y)) 0.001))

(define (half-interval-method f a b)
    (let ((a-value (f a))
        (b-value (f b)))
    (cond ((and (negative? a-value) (positive? b-value))
                (search f a b))
        ((and (negative? b-value) (positive? a-value))
              (search f b a))
          (else
              (error "У aргументов не рiзнi знаки" a b)))))
    
; NEWTON
(define (ogFunc x)
    (- (- (* x x) 1) (cos (* 5 x))))

(define (derFunc x)
    (+ (* 2 x) (* 5 (sin (* 5 x)))))

(define x1 0)
(define counter 0)
(define (newton-method x0)
        (set! x1 (- x0 (/ (ogFunc x0) (derFunc x0))))
            (if (close-enough? x1 x0)
             x0
            (newton-method x1)))
(display "Знайти корені нелінійного рівняння виду  x^2-1-cos⁡5 x=0. Пошук наближеного значення хоча б одного кореня рівняння f(x) = 0 на відрізку [a; b] здійснювати методами бісекціїї та дотичних. Значення a, b інтервалу вибрати самостійн Порівняти результати розв’язків двома методами.")
(newline)
(display "half-interval-method = ")
(define HL (half-interval-method (lambda (x)
                                (- (- (* x x) 1) (cos (* 5 x)))
                                 ) 1 2))
(display HL)                             
(newline)
(display "newtons-method = ")
(define NEW (newton-method 5))
(display NEW)  
(newline)
(display "Різниця між методами = ")
(display (- HL NEW))
